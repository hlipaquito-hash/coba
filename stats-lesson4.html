<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Visualizations | Statistics Curriculum</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/plotly.js/3.0.3/plotly.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .hero-bg { background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); }
        .quiz-option { transition: all 0.3s ease; }
        .quiz-option:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(0,0,0,0.1); }
        .quiz-option.selected { background: linear-gradient(135deg, #f59e0b, #d97706); color: white; }
        .quiz-option.correct { background: linear-gradient(135deg, #10b981, #059669); color: white; }
        .quiz-option.incorrect { background: linear-gradient(135deg, #ef4444, #dc2626); color: white; }
        .chart-container { transition: all 0.3s ease; }
        .chart-container:hover { transform: translateY(-4px); box-shadow: 0 12px 30px rgba(0,0,0,0.1); }
        .viz-demo { animation: pulse 3s infinite; }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Navigation -->
    <nav class="bg-white shadow-lg fixed w-full top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <div class="flex-shrink-0">
                        <a href="stats-index.html" class="text-xl font-bold text-gray-900">üìä Football Analytics Academy</a>
                    </div>
                </div>
                <div class="flex items-center space-x-8">
                    <a href="stats-index.html" class="text-gray-700 hover:text-blue-600 font-medium">Home</a>
                    <a href="stats-lesson1.html" class="text-gray-700 hover:text-blue-600 font-medium">Introduction</a>
                    <a href="stats-lesson2.html" class="text-gray-700 hover:text-green-600 font-medium">Data Types</a>
                    <a href="stats-lesson3.html" class="text-gray-700 hover:text-purple-600 font-medium">Averages</a>
                    <a href="#" class="text-orange-600 font-medium">Visualizations</a>
                    <a href="stats-lesson5.html" class="text-gray-700 hover:text-red-600 font-medium">Probability</a>
                    <a href="stats-assessment.html" class="text-gray-700 hover:text-gray-600 font-medium">Assessment</a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero-bg pt-16 pb-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center text-white">
            <h1 class="text-4xl md:text-6xl font-black mb-4">Data Visualizations</h1>
            <p class="text-xl md:text-2xl mb-6">Bringing Football Data to Life</p>
            <div class="bg-white bg-opacity-20 rounded-lg p-4 inline-block">
                <p class="text-lg font-medium">"A picture is worth a thousand data points in football analytics."</p>
            </div>
        </div>
    </section>

    <!-- Main Content -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
        <div class="grid lg:grid-cols-3 gap-8">
            <!-- Theory Section -->
            <div class="lg:col-span-2 space-y-8">
                <!-- Core Concept -->
                <div class="bg-white rounded-xl shadow-lg p-8">
                    <h2 class="text-3xl font-bold text-gray-900 mb-6">Types of Football Visualizations</h2>
                    <div class="space-y-6">
                        <div class="concept-card bg-orange-50 rounded-lg p-6">
                            <h3 class="text-xl font-semibold text-orange-900 mb-3">Why Visualize Data?</h3>
                            <p class="text-orange-700 leading-relaxed">
                                Data visualizations help us quickly understand patterns, trends, and insights that might be hidden in raw numbers. 
                                In football analytics, visualizations can reveal tactical patterns, player performance trends, and team comparisons 
                                at a glance.
                            </p>
                        </div>

                        <div class="grid md:grid-cols-2 gap-6">
                            <div class="bg-gray-50 rounded-lg p-6">
                                <h4 class="font-semibold text-gray-900 mb-3">üìà Quantitative Charts</h4>
                                <p class="text-gray-700 text-sm mb-3">Show numerical relationships and comparisons</p>
                                <ul class="text-xs text-gray-600 space-y-1">
                                    <li>‚Ä¢ Bar charts for comparisons</li>
                                    <li>‚Ä¢ Line graphs for trends</li>
                                    <li>‚Ä¢ Scatter plots for correlations</li>
                                    <li>‚Ä¢ Histograms for distributions</li>
                                </ul>
                            </div>
                            <div class="bg-gray-50 rounded-lg p-6">
                                <h4 class="font-semibold text-gray-900 mb-3">üó∫Ô∏è Spatial Visualizations</h4>
                                <p class="text-gray-700 text-sm mb-3">Show position and movement on the pitch</p>
                                <ul class="text-xs text-gray-600 space-y-1">
                                    <li>‚Ä¢ Heat maps for activity</li>
                                    <li>‚Ä¢ Shot maps for scoring chances</li>
                                    <li>‚Ä¢ Pass networks for connections</li>
                                    <li>‚Ä¢ Player tracking for movement</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Bar Charts Section -->
                <div class="bg-white rounded-xl shadow-lg p-8">
                    <h2 class="text-3xl font-bold text-gray-900 mb-6">Bar Charts: Player Comparisons</h2>
                    <div class="space-y-6">
                        <div class="border-l-4 border-blue-500 pl-6">
                            <h3 class="text-xl font-semibold text-gray-900 mb-3">When to Use Bar Charts</h3>
                            <p class="text-gray-700 mb-4">
                                Bar charts are perfect for comparing discrete categories or players. They make it easy to see which player 
                                performs better in specific metrics or how teams compare across different statistics.
                            </p>
                            <div class="bg-blue-50 p-4 rounded-lg">
                                <p class="text-sm text-blue-800">
                                    <strong>Best for:</strong> Comparing players, teams, or seasons across specific metrics like goals, assists, or pass completion.
                                </p>
                            </div>
                        </div>

                        <div class="chart-container bg-gray-50 rounded-lg p-6">
                            <h4 class="font-semibold text-gray-900 mb-4">Interactive Bar Chart: Top Scorers Comparison</h4>
                            <div class="grid md:grid-cols-2 gap-6">
                                <div>
                                    <div id="bar-chart" class="h-80"></div>
                                </div>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Select Metric:</label>
                                        <select id="bar-metric" class="w-full p-2 border border-gray-300 rounded" onchange="updateBarChart()">
                                            <option value="goals">Goals</option>
                                            <option value="assists">Assists</option>
                                            <option value="shots">Shots</option>
                                            <option value="xg">Expected Goals (xG)</option>
                                        </select>
                                    </div>
                                    <div class="bg-white p-4 rounded-lg">
                                        <h5 class="font-semibold text-gray-900 mb-2">Analysis</h5>
                                        <p id="bar-analysis" class="text-sm text-gray-700">
                                            Compare different metrics to see how players perform across various aspects of the game.
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Pie Charts Section -->
                <div class="bg-white rounded-xl shadow-lg p-8">
                    <h2 class="text-3xl font-bold text-gray-900 mb-6">Pie Charts: Possession & Contribution</h2>
                    <div class="space-y-6">
                        <div class="border-l-4 border-green-500 pl-6">
                            <h3 class="text-xl font-semibold text-gray-900 mb-3">When to Use Pie Charts</h3>
                            <p class="text-gray-700 mb-4">
                                Pie charts show how a whole is divided into parts. They're excellent for showing possession percentages, 
                                types of passes, or contribution breakdowns within a team.
                            </p>
                            <div class="bg-green-50 p-4 rounded-lg">
                                <p class="text-sm text-green-800">
                                    <strong>Best for:</strong> Showing proportions like possession (60%-40%), pass types, or shot locations.
                                </p>
                            </div>
                        </div>

                        <div class="chart-container bg-gray-50 rounded-lg p-6">
                            <h4 class="font-semibold text-gray-900 mb-4">Interactive Pie Chart: Match Statistics</h4>
                            <div class="grid md:grid-cols-2 gap-6">
                                <div>
                                    <div id="pie-chart" class="h-80"></div>
                                </div>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Team A Possession (%):</label>
                                        <input type="range" id="possession-slider" min="30" max="70" value="58" 
                                               class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"
                                               onchange="updatePieChart()">
                                        <span id="possession-value" class="text-sm text-gray-600">58%</span>
                                    </div>
                                    <div class="bg-white p-4 rounded-lg">
                                        <h5 class="font-semibold text-gray-900 mb-2">Match Impact</h5>
                                        <p id="possession-analysis" class="text-sm text-gray-700">
                                            Higher possession often correlates with match control, but effectiveness matters more than just possession.
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Line Graphs Section -->
                <div class="bg-white rounded-xl shadow-lg p-8">
                    <h2 class="text-3xl font-bold text-gray-900 mb-6">Line Graphs: Performance Over Time</h2>
                    <div class="space-y-6">
                        <div class="border-l-4 border-purple-500 pl-6">
                            <h3 class="text-xl font-semibold text-gray-900 mb-3">When to Use Line Graphs</h3>
                            <p class="text-gray-700 mb-4">
                                Line graphs are perfect for showing trends and changes over time. They're essential for tracking player form, 
                                team performance across a season, or how metrics evolve throughout a match.
                            </p>
                            <div class="bg-purple-50 p-4 rounded-lg">
                                <p class="text-sm text-purple-800">
                                    <strong>Best for:</strong> Tracking form over time, seasonal performance, or minute-by-minute match data.
                                </p>
                            </div>
                        </div>

                        <div class="chart-container bg-gray-50 rounded-lg p-6">
                            <h4 class="font-semibold text-gray-900 mb-4">Interactive Line Graph: Season Performance</h4>
                            <div class="grid md:grid-cols-2 gap-6">
                                <div>
                                    <div id="line-chart" class="h-80"></div>
                                </div>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Select Player:</label>
                                        <select id="player-select" class="w-full p-2 border border-gray-300 rounded" onchange="updateLineChart()">
                                            <option value="striker">Striker</option>
                                            <option value="midfielder">Midfielder</option>
                                            <option value="defender">Defender</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Metric:</label>
                                        <select id="line-metric" class="w-full p-2 border border-gray-300 rounded" onchange="updateLineChart()">
                                            <option value="goals">Goals per Match</option>
                                            <option value="passes">Passes per Match</option>
                                            <option value="distance">Distance Covered (km)</option>
                                        </select>
                                    </div>
                                    <div class="bg-white p-4 rounded-lg">
                                        <h5 class="font-semibold text-gray-900 mb-2">Form Analysis</h5>
                                        <p id="line-analysis" class="text-sm text-gray-700">
                                            Track how player performance evolves throughout the season.
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Advanced Visualizations -->
                <div class="bg-white rounded-xl shadow-lg p-8">
                    <h2 class="text-3xl font-bold text-gray-900 mb-6">Advanced Football Visualizations</h2>
                    <div class="space-y-6">
                        <!-- Shot Map -->
                        <div class="border-l-4 border-red-500 pl-6">
                            <h3 class="text-xl font-semibold text-gray-900 mb-3">üéØ Shot Maps</h3>
                            <p class="text-gray-700 mb-4">
                                Shot maps show where shots are taken from on the pitch, with different colors/sizes representing shot quality (xG) and outcomes (goals/saves/misses).
                            </p>
                            <div class="bg-red-50 p-4 rounded-lg">
                                <div class="grid md:grid-cols-2 gap-4 text-sm">
                                    <div>
                                        <strong>Red dots:</strong> Goals scored<br>
                                        <strong>Blue dots:</strong> Shots on target<br>
                                        <strong>Gray dots:</strong> Shots off target
                                    </div>
                                    <div>
                                        <strong>Size:</strong> Represents xG value<br>
                                        <strong>Clustering:</strong> Shows preferred shooting zones
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Performance Radar -->
                        <div class="border-l-4 border-blue-500 pl-6">
                            <h3 class="text-xl font-semibold text-gray-900 mb-3">üìä Performance Radar Charts</h3>
                            <p class="text-gray-700 mb-4">
                                Radar charts compare multiple performance metrics simultaneously, giving a complete picture of a player's abilities across different aspects of the game.
                            </p>
                            <div class="bg-blue-50 p-4 rounded-lg">
                                <div class="grid md:grid-cols-2 gap-4 text-sm">
                                    <div>
                                        <strong>Axes:</strong> Different performance metrics<br>
                                        <strong>Area:</strong> Overall performance level<br>
                                        <strong>Shape:</strong> Player's skill profile
                                    </div>
                                    <div>
                                        <strong>Comparison:</strong> Overlay multiple players<br>
                                        <strong>Weaknesses:</strong> Identify areas for improvement
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Pass Networks -->
                        <div class="border-l-4 border-green-500 pl-6">
                            <h3 class="text-xl font-semibold text-gray-900 mb-3">üï∏Ô∏è Pass Networks</h3>
                            <p class="text-gray-700 mb-4">
                                Pass networks show how players connect with each other on the pitch. The thickness and frequency of lines between players indicate passing relationships and team chemistry.
                            </p>
                            <div class="bg-green-50 p-4 rounded-lg">
                                <div class="grid md:grid-cols-2 gap-4 text-sm">
                                    <div>
                                        <strong>Nodes:</strong> Player positions<br>
                                        <strong>Lines:</strong> Pass connections<br>
                                        <strong>Thickness:</strong> Pass frequency
                                    </div>
                                    <div>
                                        <strong>Color:</strong> Pass completion rate<br>
                                        <strong>Clusters:</strong> Playing partnerships<br>
                                        <strong>Gaps:</strong> Communication issues
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Interactive Visualization Builder -->
                <div class="bg-white rounded-xl shadow-lg p-8">
                    <h2 class="text-3xl font-bold text-gray-900 mb-6">Build Your Own Visualization</h2>
                    <div class="space-y-6">
                        <div class="grid md:grid-cols-3 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Chart Type:</label>
                                <select id="chart-type" class="w-full p-2 border border-gray-300 rounded" onchange="updateCustomChart()">
                                    <option value="bar">Bar Chart</option>
                                    <option value="line">Line Graph</option>
                                    <option value="scatter">Scatter Plot</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Data Type:</label>
                                <select id="data-type" class="w-full p-2 border border-gray-300 rounded" onchange="updateCustomChart()">
                                    <option value="performance">Player Performance</option>
                                    <option value="team">Team Statistics</option>
                                    <option value="match">Match Data</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Time Period:</label>
                                <select id="time-period" class="w-full p-2 border border-gray-300 rounded" onchange="updateCustomChart()">
                                    <option value="season">Full Season</option>
                                    <option value="month">Last Month</option>
                                    <option value="matches">Last 5 Matches</option>
                                </select>
                            </div>
                        </div>
                        
                        <div id="custom-chart" class="h-96 bg-gray-50 rounded-lg"></div>
                        
                        <div class="bg-orange-50 p-4 rounded-lg">
                            <h4 class="font-semibold text-orange-900 mb-2">Visualization Tips</h4>
                            <ul class="text-sm text-orange-800 space-y-1">
                                <li>‚Ä¢ Choose the right chart for your data type and message</li>
                                <li>‚Ä¢ Use colors strategically to highlight important information</li>
                                <li>‚Ä¢ Keep designs clean and avoid unnecessary decorations</li>
                                <li>‚Ä¢ Always include clear labels and scales</li>
                                <li>‚Ä¢ Consider your audience when designing visualizations</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Sidebar -->
            <div class="space-y-8">
                <!-- Quick Quiz -->
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h3 class="text-2xl font-bold text-gray-900 mb-4">Quick Check</h3>
                    <div id="quiz-container">
                        <div class="quiz-question mb-4">
                            <p class="font-medium text-gray-900 mb-3">Which visualization is best for showing how a player's performance changes over a season?</p>
                            <div class="space-y-2">
                                <button class="quiz-option w-full text-left p-3 rounded-lg bg-gray-50 hover:bg-gray-100" 
                                        onclick="selectAnswer(this, false)">
                                    A) Bar chart
                                </button>
                                <button class="quiz-option w-full text-left p-3 rounded-lg bg-gray-50 hover:bg-gray-100" 
                                        onclick="selectAnswer(this, true)">
                                    B) Line graph
                                </button>
                                <button class="quiz-option w-full text-left p-3 rounded-lg bg-gray-50 hover:bg-gray-100" 
                                        onclick="selectAnswer(this, false)">
                                    C) Pie chart
                                </button>
                                <button class="quiz-option w-full text-left p-3 rounded-lg bg-gray-50 hover:bg-gray-100" 
                                        onclick="selectAnswer(this, false)">
                                    D) Shot map
                                </button>
                            </div>
                            <div id="quiz-feedback" class="mt-4 p-3 rounded-lg hidden"></div>
                        </div>
                    </div>
                </div>

                <!-- Key Terms -->
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h3 class="text-2xl font-bold text-gray-900 mb-4">Key Terms</h3>
                    <div class="space-y-4">
                        <div class="border-b border-gray-200 pb-3">
                            <h4 class="font-semibold text-gray-900">Bar Chart</h4>
                            <p class="text-sm text-gray-600">Compares categories with rectangular bars</p>
                        </div>
                        <div class="border-b border-gray-200 pb-3">
                            <h4 class="font-semibold text-gray-900">Pie Chart</h4>
                            <p class="text-sm text-gray-600">Shows proportions of a whole</p>
                        </div>
                        <div class="border-b border-gray-200 pb-3">
                            <h4 class="font-semibold text-gray-900">Line Graph</h4>
                            <p class="text-sm text-gray-600">Shows trends over time</p>
                        </div>
                        <div>
                            <h4 class="font-semibold text-gray-900">Heat Map</h4>
                            <p class="text-sm text-gray-600">Shows activity intensity on a map</p>
                        </div>
                    </div>
                </div>

                <!-- Progress Tracker -->
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h3 class="text-2xl font-bold text-gray-900 mb-4">Lesson Progress</h3>
                    <div class="space-y-4">
                        <div class="flex items-center">
                            <div class="w-4 h-4 bg-orange-500 rounded-full mr-3"></div>
                            <span class="text-sm text-gray-700">Theory Complete</span>
                        </div>
                        <div class="flex items-center">
                            <div class="w-4 h-4 bg-orange-500 rounded-full mr-3"></div>
                            <span class="text-sm text-gray-700">Charts Explored</span>
                        </div>
                        <div class="flex items-center">
                            <div class="w-4 h-4 bg-gray-300 rounded-full mr-3"></div>
                            <span class="text-sm text-gray-700">Quiz Completed</span>
                        </div>
                        <div class="flex items-center">
                            <div class="w-4 h-4 bg-gray-300 rounded-full mr-3"></div>
                            <span class="text-sm text-gray-700">Ready for Next Lesson</span>
                        </div>
                    </div>
                    <div class="mt-6">
                        <div class="bg-gray-200 rounded-full h-2">
                            <div class="bg-orange-600 h-2 rounded-full" style="width: 75%"></div>
                        </div>
                        <p class="text-sm text-gray-600 mt-2">75% Complete</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Navigation Buttons -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <div class="flex justify-between">
            <a href="stats-lesson3.html" class="bg-gray-600 text-white px-6 py-3 rounded-lg hover:bg-gray-700 transition-colors">
                ‚Üê Averages
            </a>
            <button onclick="completeLesson()" class="bg-orange-600 text-white px-6 py-3 rounded-lg hover:bg-orange-700 transition-colors">
                Complete Lesson ‚Üí
            </button>
        </div>
    </div>

    <script>
        // Sample data for visualizations
        const sampleData = {
            players: ['Messi', 'Ronaldo', 'Lewandowski', 'Haaland', 'Mbappe'],
            goals: [30, 25, 35, 28, 22],
            assists: [15, 8, 12, 6, 18],
            shots: [120, 135, 95, 110, 98],
            xg: [25.5, 22.8, 31.2, 26.1, 19.7]
        };

        const playerSeasonData = {
            striker: {
                name: 'Striker',
                data: [0.8, 1.2, 0.5, 1.5, 0.9, 1.1, 0.7, 1.3, 1.0, 0.6]
            },
            midfielder: {
                name: 'Midfielder', 
                data: [0.3, 0.5, 0.2, 0.8, 0.4, 0.6, 0.3, 0.7, 0.5, 0.4]
            },
            defender: {
                name: 'Defender',
                data: [0.1, 0.2, 0.0, 0.3, 0.1, 0.1, 0.0, 0.2, 0.1, 0.1]
            }
        };

        // Initialize charts
        function initializeCharts() {
            createBarChart();
            createPieChart();
            createLineChart();
            createCustomChart();
        }

        function createBarChart() {
            const trace = {
                x: sampleData.players,
                y: sampleData.goals,
                type: 'bar',
                marker: {
                    color: ['#ef4444', '#3b82f6', '#10b981', '#f59e0b', '#8b5cf6']
                },
                text: sampleData.goals,
                textposition: 'auto'
            };

            const layout = {
                title: 'Goals Scored This Season',
                xaxis: { title: 'Players' },
                yaxis: { title: 'Goals' },
                showlegend: false,
                font: { family: 'Inter, sans-serif' }
            };

            Plotly.newPlot('bar-chart', [trace], layout, {displayModeBar: false});
        }

        function updateBarChart() {
            const metric = document.getElementById('bar-metric').value;
            const data = sampleData[metric];
            const title = metric === 'goals' ? 'Goals Scored' : 
                         metric === 'assists' ? 'Assists Made' :
                         metric === 'shots' ? 'Total Shots' : 'Expected Goals (xG)';

            const trace = {
                x: sampleData.players,
                y: data,
                type: 'bar',
                marker: {
                    color: ['#ef4444', '#3b82f6', '#10b981', '#f59e0b', '#8b5cf6']
                },
                text: data,
                textposition: 'auto'
            };

            const layout = {
                title: title + ' This Season',
                xaxis: { title: 'Players' },
                yaxis: { title: title },
                showlegend: false,
                font: { family: 'Inter, sans-serif' }
            };

            Plotly.newPlot('bar-chart', [trace], layout, {displayModeBar: false});

            // Update analysis
            const maxValue = Math.max(...data);
            const maxPlayer = sampleData.players[data.indexOf(maxValue)];
            document.getElementById('bar-analysis').textContent = 
                `${maxPlayer} leads with ${maxValue} ${metric}. The chart clearly shows performance differences between players.`;
        }

        function createPieChart() {
            const possession = 58;
            const trace = {
                labels: ['Team A Possession', 'Team B Possession'],
                values: [possession, 100 - possession],
                type: 'pie',
                marker: {
                    colors: ['#3b82f6', '#6b7280']
                },
                textinfo: 'label+percent',
                textposition: 'auto'
            };

            const layout = {
                title: 'Match Possession Statistics',
                showlegend: false,
                font: { family: 'Inter, sans-serif' }
            };

            Plotly.newPlot('pie-chart', [trace], layout, {displayModeBar: false});
        }

        function updatePieChart() {
            const possession = document.getElementById('possession-slider').value;
            document.getElementById('possession-value').textContent = possession + '%';

            const trace = {
                labels: ['Team A Possession', 'Team B Possession'],
                values: [possession, 100 - possession],
                type: 'pie',
                marker: {
                    colors: ['#3b82f6', '#6b7280']
                },
                textinfo: 'label+percent',
                textposition: 'auto'
            };

            Plotly.newPlot('pie-chart', [trace], layout, {displayModeBar: false});

            // Update analysis
            let analysis = '';
            if (possession > 60) {
                analysis = 'Team A dominates possession, likely controlling the game tempo and creating more chances.';
            } else if (possession > 50) {
                analysis = 'Team A has slight possession advantage, but it\'s a fairly balanced match.';
            } else {
                analysis = 'Team B has more possession. Team A might be playing a counter-attacking style.';
            }
            document.getElementById('possession-analysis').textContent = analysis;
        }

        function createLineChart() {
            const matches = Array.from({length: 10}, (_, i) => `Match ${i + 1}`);
            const strikerData = playerSeasonData.striker.data;

            const trace = {
                x: matches,
                y: strikerData,
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Striker',
                line: { color: '#ef4444', width: 3 },
                marker: { size: 8 }
            };

            const layout = {
                title: 'Goals per Match - Season Form',
                xaxis: { title: 'Matches' },
                yaxis: { title: 'Goals per Match' },
                showlegend: false,
                font: { family: 'Inter, sans-serif' }
            };

            Plotly.newPlot('line-chart', [trace], layout, {displayModeBar: false});
        }

        function updateLineChart() {
            const player = document.getElementById('player-select').value;
            const metric = document.getElementById('line-metric').value;
            const matches = Array.from({length: 10}, (_, i) => `Match ${i + 1}`);
            const data = playerSeasonData[player].data;

            const title = metric === 'goals' ? 'Goals per Match' :
                         metric === 'passes' ? 'Key Passes per Match' :
                         'Distance Covered (km)';

            const trace = {
                x: matches,
                y: data,
                type: 'scatter',
                mode: 'lines+markers',
                name: playerSeasonData[player].name,
                line: { color: '#ef4444', width: 3 },
                marker: { size: 8 }
            };

            const layout = {
                title: title + ' - Season Form',
                xaxis: { title: 'Matches' },
                yaxis: { title: title },
                showlegend: false,
                font: { family: 'Inter, sans-serif' }
            };

            Plotly.newPlot('line-chart', [trace], layout, {displayModeBar: false});

            // Update analysis
            const avg = (data.reduce((a, b) => a + b, 0) / data.length).toFixed(2);
            const trend = data[data.length - 1] > data[0] ? 'improving' : 'declining';
            document.getElementById('line-analysis').textContent = 
                `${playerSeasonData[player].name} averages ${avg} ${metric} per match. Form is ${trend} throughout the season.`;
        }

        function createCustomChart() {
            updateCustomChart();
        }

        function updateCustomChart() {
            const chartType = document.getElementById('chart-type').value;
            const dataType = document.getElementById('data-type').value;
            const timePeriod = document.getElementById('time-period').value;

            // Generate sample data based on selections
            let data, layout;

            if (chartType === 'bar') {
                const categories = dataType === 'performance' ? 
                    ['Goals', 'Assists', 'Shots', 'Passes'] : 
                    dataType === 'team' ? 
                    ['Possession', 'Shots', 'Corners', 'Fouls'] :
                    ['1st Half', '2nd Half', 'Extra Time'];
                
                const values = categories.map(() => Math.floor(Math.random() * 100) + 20);

                data = [{
                    x: categories,
                    y: values,
                    type: 'bar',
                    marker: { color: '#f59e0b' }
                }];

                layout = {
                    title: `${dataType} data - ${timePeriod}`,
                    font: { family: 'Inter, sans-serif' }
                };
            } else if (chartType === 'line') {
                const points = timePeriod === 'season' ? 38 : timePeriod === 'month' ? 4 : 5;
                const x = Array.from({length: points}, (_, i) => `Point ${i + 1}`);
                const y = Array.from({length: points}, () => Math.random() * 10 + 5);

                data = [{
                    x: x,
                    y: y,
                    type: 'scatter',
                    mode: 'lines+markers',
                    line: { color: '#f59e0b' }
                }];

                layout = {
                    title: `${dataType} trend - ${timePeriod}`,
                    font: { family: 'Inter, sans-serif' }
                };
            } else {
                const x = Array.from({length: 20}, () => Math.random() * 100);
                const y = x.map(xi => xi * 0.8 + Math.random() * 20);

                data = [{
                    x: x,
                    y: y,
                    type: 'scatter',
                    mode: 'markers',
                    marker: { color: '#f59e0b' }
                }];

                layout = {
                    title: `${dataType} correlation - ${timePeriod}`,
                    font: { family: 'Inter, sans-serif' }
                };
            }

            Plotly.newPlot('custom-chart', data, layout, {displayModeBar: false});
        }

        // Quiz functionality
        function selectAnswer(button, isCorrect) {
            // Remove previous selections
            document.querySelectorAll('.quiz-option').forEach(opt => {
                opt.classList.remove('selected', 'correct', 'incorrect');
            });
            
            // Mark selected answer
            button.classList.add('selected');
            
            // Show feedback
            const feedback = document.getElementById('quiz-feedback');
            if (isCorrect) {
                button.classList.add('correct');
                feedback.innerHTML = '<i class="fas fa-check-circle text-green-500 mr-2"></i>Correct! Line graphs are perfect for showing trends and changes over time, making them ideal for tracking performance evolution.';
                feedback.className = 'mt-4 p-3 rounded-lg bg-green-50 text-green-800 border border-green-200';
            } else {
                button.classList.add('incorrect');
                feedback.innerHTML = '<i class="fas fa-times-circle text-red-500 mr-2"></i>Not quite right. The correct answer is B - line graphs are best for showing performance changes over time.';
                feedback.className = 'mt-4 p-3 rounded-lg bg-red-50 text-red-800 border border-red-200';
            }
            feedback.classList.remove('hidden');
        }

        function completeLesson() {
            // Update progress
            let progress = JSON.parse(localStorage.getItem('statsProgress') || '{"intro": 0, "data": 0, "averages": 0, "viz": 0, "prob": 0, "assessment": 0}');
            progress.viz = 100;
            localStorage.setItem('statsProgress', JSON.stringify(progress));
            
            // Navigate to next lesson
            window.location.href = 'stats-lesson5.html';
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            initializeCharts();
        });
    </script>
</body>
</html>